<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Projets â€” Hugo Daoust</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=29">
    
    <!-- Preload critical resources with high priority for local development -->
    <link rel="preload" href="data.js" as="script" fetchpriority="high">
    <link rel="preload" href="media/index.js" as="script" fetchpriority="high">
    <link rel="preload" href="neural-network.js" as="script" fetchpriority="high">
    
    <!-- Preconnect to improve loading performance -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
</head>
<!-- 
    HOVER STATE AS DEFAULT - Easy Rollback
    To rollback to original hover behavior, change the class to:
    <body class="neural-network-style original-hover">
    Or simply remove the "hover-as-default" class
-->
<body class="neural-network-style original-hover">
    <!-- Concentric squares parallax background -->
    <div class="concentric-squares">
        <!-- Squares will be generated dynamically based on viewport size -->
    </div>
    
    <div class="main-container">
        <section class="project-section" id="section-1">
            <main id="list-1" class="project-grid"></main>
        </section>
    </div>
    
    <!-- Critical CSS inline for faster rendering -->
    <style>
        /* Critical above-the-fold styles */
        body { margin: 0; padding: 0; background: #000; color: #fff; font-family: 'Inter', sans-serif; }
        .main-container { min-height: 100vh; position: relative; }
        .concentric-squares { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1; }
        .project-section { position: relative; z-index: 10; }
        .project-grid { display: flex; flex-wrap: wrap; gap: 20px; padding: 20px; }
        .loading { 
            text-align: center; 
            padding: 50px; 
            color: #90EE90; 
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.2rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #90EE90;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-dots::after {
            content: '';
            animation: dots 1.5s infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
    </style>
    
    <!-- Load non-critical resources asynchronously -->
    <script>
        // Show loading state immediately
        document.addEventListener('DOMContentLoaded', function() {
            const projectGrid = document.getElementById('list-1');
            projectGrid.innerHTML = '<div class="loading loading-dots">Loading projects</div>';
        });
    </script>
    
    <!-- Load data asynchronously to prevent blocking -->
    <script>
        // Load data asynchronously with caching
        function loadData() {
            return new Promise((resolve) => {
                // Check if data is already cached in sessionStorage
                const cachedData = sessionStorage.getItem('projectsData');
                const cachedMedia = sessionStorage.getItem('mediaData');
                
                // Clear cache to force fresh load (temporary fix)
                sessionStorage.removeItem('projectsData');
                sessionStorage.removeItem('mediaData');
                console.log('Cache cleared, loading fresh data...');
                
                if (false && cachedData && cachedMedia) {
                    console.log('Using cached data from sessionStorage');
                    try {
                        window.projects = JSON.parse(cachedData);
                        window.projectMedia = JSON.parse(cachedMedia);
                        // Load neural network script
                        const neuralScript = document.createElement('script');
                        neuralScript.src = 'neural-network.js?v=29';
                        neuralScript.onload = () => {
                            setTimeout(() => {
                                console.log('Cached data path - About to initialize neural network...');
                                console.log('window.projects at init time (cached):', window.projects);
                                console.log('window.projects length at init time (cached):', window.projects ? window.projects.length : 'undefined');
                                if (window.initializeNeuralNetwork) {
                                    console.log('Calling initializeNeuralNetwork (cached)...');
                                    window.initializeNeuralNetwork();
                                } else {
                                    console.log('initializeNeuralNetwork function not found (cached)!');
                                }
                                resolve();
                            }, 100);
                        };
                        document.head.appendChild(neuralScript);
                        return;
                    } catch (e) {
                        console.log('Cached data corrupted, loading fresh');
                    }
                }
                
                // Load fresh data
                const script = document.createElement('script');
                script.src = 'data.js?v=13';
                script.onload = () => {
                    console.log('data.js loaded, window.projects:', window.projects);
                    console.log('window.projects length:', window.projects ? window.projects.length : 'undefined');
                    const mediaScript = document.createElement('script');
                    mediaScript.src = 'media/index.js?v=9';
                    mediaScript.onload = () => {
                        console.log('media/index.js loaded, window.projectMedia:', window.projectMedia);
                        // Cache the data for future use
                        sessionStorage.setItem('projectsData', JSON.stringify(window.projects));
                        sessionStorage.setItem('mediaData', JSON.stringify(window.projectMedia));
                        console.log('Data cached in sessionStorage');
                        
                        const neuralScript = document.createElement('script');
                        neuralScript.src = 'neural-network.js?v=29';
                        neuralScript.onload = () => {
                            // Small delay to ensure data is fully loaded
                            setTimeout(() => {
                                console.log('About to initialize neural network...');
                                console.log('window.projects at init time:', window.projects);
                                console.log('window.projects length at init time:', window.projects ? window.projects.length : 'undefined');
                                // Refresh project cache to ensure overlay and project pages are synchronized
                                if (window.refreshProjectCache) {
                                    window.refreshProjectCache();
                                }
                                // Initialize the neural network after script is loaded
                                if (window.initializeNeuralNetwork) {
                                    console.log('Calling initializeNeuralNetwork...');
                                    window.initializeNeuralNetwork();
                                } else {
                                    console.log('initializeNeuralNetwork function not found!');
                                }
                                resolve();
                            }, 100);
                        };
                        document.head.appendChild(neuralScript);
                    };
                    document.head.appendChild(mediaScript);
                };
                document.head.appendChild(script);
            });
        }
        
        // Start loading data when DOM is ready
        document.addEventListener('DOMContentLoaded', async function() {
            const projectGrid = document.getElementById('list-1');
            if (projectGrid) {
                projectGrid.innerHTML = '<div class="loading loading-dots">Loading projects</div>';
            }
            
            try {
                await loadData();
                // Neural network is initialized in loadData() after scripts are loaded
            } catch (error) {
                console.error('Error loading data:', error);
                if (projectGrid) {
                    projectGrid.innerHTML = '<div class="loading">Error loading projects</div>';
                }
            }
        });
    </script>

    
</body>
</html>